<?xml version="1.0" encoding="utf-8"?>
<!--
// ==================================================================
// Module:		Hough Transform Test
//
// Description:	Famous Hough Transform to identify lines.
//
// Reference:	Digital Image Processing by Gonzales & Woods
//
// Author(s):	C.T. Yeung									cty
//
// History:
// 20Sep09		start											cty
// ==================================================================
-->
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" 
			    creationComplete="onCreationComplete()"
				layout="absolute" viewSourceURL="srcview/index.html">
	
	<mx:Script>
		<![CDATA[
			import com.ctyeung.transform.ChannelSelector;
			import com.ctyeung.transform.Convolution;
			import com.ctyeung.transform.HoughLine;
			
			[Embed(source="assets/Hexagons.png")]public var photoClass1:Class;
			protected var bmd:BitmapData;
			
			
			protected function onCreationComplete():void {
				bmd = new photoClass1().bitmapData;
				uic.addChild(new Bitmap(bmd));
			}
			
			protected function onChangeAngle():void {
				if(uicDes.numChildren){
					var bmp:Bitmap = uicDes.getChildAt(0) as Bitmap;
					bmp.bitmapData.dispose();
					bmp = null;
					uicDes.removeChildAt(0);
				}
				var bmdDes:BitmapData = bmd.clone();
				ChannelSelector.apply(bmdDes, ChannelSelector.SELECT_GRAY);
				Convolution.firstDerivative(bmdDes, threshold.value);
				HoughLine.apply(bmdDes, slide.value, threshold.value);
				uicDes.addChild(new Bitmap(bmdDes));
			}
		]]>
	</mx:Script>
	
	<mx:HBox width="100%" height="100%">
		<mx:Spacer width="50"/>
		<mx:VBox>
			<mx:HSlider id="slide" labels="Angle:" minimum="0" maximum="90" value="45" change="onChangeAngle()"/>
			<mx:HSlider id="threshold" labels="Threshold:" minimum="0" maximum="255" value="1" change="onChangeAngle()"/>
			
			<mx:VBox borderColor="0" borderStyle="solid" borderThickness="1">
				<mx:UIComponent id="uic"/>
				<mx:UIComponent id="uicDes"/>
			</mx:VBox>
		</mx:VBox>
	</mx:HBox>
</mx:Application>
